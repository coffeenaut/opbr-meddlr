import{r as i,j as s,D as L,k as $,i as _,o as B,p as G,q as K,s as q}from"./index-b605aa63.js";import{b as C,s as j,w as z,c as N,u as O,d as P,r as V,e as Y,f as J}from"./MedalView-8d1b1fca.js";function Q({title:n,titleId:e,...r},t){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":e},r),n?i.createElement("title",{id:e},n):null,i.createElement("path",{fillRule:"evenodd",d:"M9 3.5a5.5 5.5 0 1 0 0 11 5.5 5.5 0 0 0 0-11ZM2 9a7 7 0 1 1 12.452 4.391l3.328 3.329a.75.75 0 1 1-1.06 1.06l-3.329-3.328A7 7 0 0 1 2 9Z",clipRule:"evenodd"}))}const W=i.forwardRef(Q),X=W;function ee(n){return i.useMemo(()=>n.hooks.dragSource(),[n])}function re(n){return i.useMemo(()=>n.hooks.dragPreview(),[n])}let M=!1,y=!1;class te{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){C(!M,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return M=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{M=!1}}isDragging(){if(!this.sourceId)return!1;C(!y,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return y=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{y=!1}}subscribeToStateChange(e,r){return this.internalMonitor.subscribeToStateChange(e,r)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,r){return this.internalMonitor.isOverTarget(e,r)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}class ne{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,r=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return r&&this.disconnectDragSource(),this.handlerId?e?(r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),r):(this.lastConnectedDragSource=e,r):r}reconnectDragPreview(e=!1){const r=this.dragPreview,t=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(t&&this.disconnectDragPreview(),!!this.handlerId){if(!r){this.lastConnectedDragPreview=r;return}t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=r,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,r,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!j(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!j(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=z({dragSource:(r,t)=>{this.clearDragSource(),this.dragSourceOptions=t||null,N(r)?this.dragSourceRef=r:this.dragSourceNode=r,this.reconnectDragSource()},dragPreview:(r,t)=>{this.clearDragPreview(),this.dragPreviewOptions=t||null,N(r)?this.dragPreviewRef=r:this.dragPreviewNode=r,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}function ie(n,e){const r=O(),t=i.useMemo(()=>new ne(r.getBackend()),[r]);return P(()=>(t.dragSourceOptions=n||null,t.reconnect(),()=>t.disconnectDragSource()),[t,n]),P(()=>(t.dragPreviewOptions=e||null,t.reconnect(),()=>t.disconnectDragPreview()),[t,e]),t}function se(){const n=O();return i.useMemo(()=>new te(n),[n])}class ae{beginDrag(){const e=this.spec,r=this.monitor;let t=null;return typeof e.item=="object"?t=e.item:typeof e.item=="function"?t=e.item(r):t={},t??null}canDrag(){const e=this.spec,r=this.monitor;return typeof e.canDrag=="boolean"?e.canDrag:typeof e.canDrag=="function"?e.canDrag(r):!0}isDragging(e,r){const t=this.spec,a=this.monitor,{isDragging:d}=t;return d?d(a):r===e.getSourceId()}endDrag(){const e=this.spec,r=this.monitor,t=this.connector,{end:a}=e;a&&a(r.getItem(),r),t.reconnect()}constructor(e,r,t){this.spec=e,this.monitor=r,this.connector=t}}function oe(n,e,r){const t=i.useMemo(()=>new ae(n,e,r),[e,r]);return i.useEffect(()=>{t.spec=n},[n]),t}function le(n){return i.useMemo(()=>{const e=n.type;return C(e!=null,"spec.type must be defined"),e},[n])}function ce(n,e,r){const t=O(),a=oe(n,e,r),d=le(n);P(function(){if(d!=null){const[h,f]=V(d,a,t);return e.receiveHandlerId(h),r.receiveHandlerId(h),f}},[t,e,r,a,d])}function de(n,e){const r=Y(n,e);C(!r.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const t=se(),a=ie(r.options,r.previewOptions);return ce(r,t,a),[J(r.collect,t,a),ee(a),re(a)]}function ue({title:n,titleId:e,...r},t){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":e},r),n?i.createElement("title",{id:e},n):null,i.createElement("path",{d:"M10 3.75a2 2 0 1 0-4 0 2 2 0 0 0 4 0ZM17.25 4.5a.75.75 0 0 0 0-1.5h-5.5a.75.75 0 0 0 0 1.5h5.5ZM5 3.75a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5a.75.75 0 0 1 .75.75ZM4.25 17a.75.75 0 0 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5h1.5ZM17.25 17a.75.75 0 0 0 0-1.5h-5.5a.75.75 0 0 0 0 1.5h5.5ZM9 10a.75.75 0 0 1-.75.75h-5.5a.75.75 0 0 1 0-1.5h5.5A.75.75 0 0 1 9 10ZM17.25 10.75a.75.75 0 0 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5h1.5ZM14 10a2 2 0 1 0-4 0 2 2 0 0 0 4 0ZM10 16.25a2 2 0 1 0-4 0 2 2 0 0 0 4 0Z"}))}const ge=i.forwardRef(ue),he=ge;function fe({title:n,titleId:e,...r},t){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":e},r),n?i.createElement("title",{id:e},n):null,i.createElement("path",{fillRule:"evenodd",d:"M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z",clipRule:"evenodd"}))}const pe=i.forwardRef(fe),me=pe,ve=n=>{const e="opbr-meddlr",r=n.medal,[{isDragging:t},a]=de(()=>({type:"medal",item:{medal:r},end:(u,h)=>{const f=h.getDropResult();if(u&&f){let m=[],w=[];for(let o=0;o<3;o++){let l=L(u.medal.extra_traits.length-1),S=u.medal.extra_traits[l],I=$(S);m.push(l),w.push(I.max)}let p=u.medal;p.set_traits=m,p.set_traits_values=w,n.onDrop(p,f)}},collect:u=>({isDragging:u.isDragging(),handlerId:u.getHandlerId()})})),d=t&&"dragging";return s.jsx("img",{ref:a,className:`medal-image rounded-full ${d}`,src:`/${e}/medals/${r.image}.png`,title:r.name})},Ce=n=>{const e=B(),r=K(),[t,a]=i.useState([...Array(e.length).keys()]),d=i.useRef(null);i.useRef(null);function u(o){a([...o.map(l=>typeof l=="string"||l.type===String?parseInt(l.substring(1,l.length))+r:l)])}const h=o=>{const l=q(),[S,I]=i.useState(!1),[k,E]=i.useState(""),[F,x]=i.useState(l),[De,R]=i.useState(!1);function T(){I(!S)}const H=c=>{c.keyCode===13&&c.target.blur()},Z=(c,g)=>c.Category.localeCompare(g.Category);function A(c){if(c.sub){const g=c.sub.sort((v,D)=>v.Category.localeCompare(D.Category));x(g)}else o.filterMedal(c.medals)}function U(c){const g=c.toLowerCase();let v=[];l.forEach(D=>{v=[...v,...D.sub.filter(b=>b.Category.indexOf(g)>-1)]}),x(v.sort((D,b)=>Z(D,b)))}return s.jsxs(s.Fragment,{children:[s.jsx(he,{onClick:T,className:"icon-medium-grey cursor-pointer",title:"Filter Medals"}),s.jsxs("div",{className:`flex flex-col rounded-md absolute filter-drop cursor-pointer max-h-60 overflow-y-auto gap-y-2 ${S?"showdrop":""}`,children:[s.jsx("div",{children:s.jsx("input",{className:"w-full rounded-lg form-input",type:"text",placeholder:"filter medals",value:k,onKeyDown:H,onChange:c=>{E(c.target.value),U(c.target.value)}})}),F.map((c,g)=>s.jsx(s.Fragment,{children:s.jsx("div",{className:"capitalize}",onMouseEnter:()=>R(!0),onMouseLeave:()=>R(!1),onClick:()=>A(c),children:c.Category},g)}))]})]})},f=o=>{o.keyCode===13&&p()};function m(){a([...Array(e.length).keys()].map(o=>o))}function w(o){return t.indexOf(o)>-1}function p(){let o=d.current.value,l=[];o&&(l=G(o)),l.length>0?a([...l]):m(),d.current.blur()}return s.jsx(s.Fragment,{children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("div",{}),s.jsxs("div",{className:"flex -translate-y-2.5 p-2 fixed justify-between medal-toolbar",children:[s.jsxs("div",{className:"flex w-3/4 lg:w-1/2 search",children:[s.jsx("input",{ref:d,onKeyDown:f,className:"w-full rounded-lg form-input",type:"text",placeholder:"search medals"}),s.jsx(X,{className:"-translate-x-9 translate-y-1 icon-medium-grey cursor-pointer",onClick:p}),s.jsx(me,{className:"cursor-pointer icon-medium-tertiary",onClick:m,title:"Reset"})]}),s.jsx("div",{className:"filter",children:s.jsx(h,{filterMedal:u})})]}),s.jsx("div",{className:"grid grid-cols-3 lg:grid-cols-5 xl:grid-cols-6 gap-4 medal-list",children:e.map((o,l)=>!_(o)&&s.jsx("div",{className:`${w(l)?"show spin-medal":"hide"}`,children:s.jsx(ve,{onDrop:n.dropped,medal:o},l)}))})]})})};export{Ce as default};
