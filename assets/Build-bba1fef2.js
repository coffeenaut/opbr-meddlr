import{g as se,j as a,r as l,B as U,i as v,_ as le,S as z,X as B,M as re,T as ne,a as oe,G as ie,I as F,b as ce}from"./index-c87b6df6.js";import{M as E,D as de,i as me,T as ue,H as fe,a as xe}from"./MedalView-da9ce4e4.js";var pe=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,r=[],m=0;m<e.rangeCount;m++)r.push(e.getRangeAt(m));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null;break}return e.removeAllRanges(),function(){e.type==="Caret"&&e.removeAllRanges(),e.rangeCount||r.forEach(function(x){e.addRange(x)}),t&&t.focus()}},he=pe,O={"text/plain":"Text","text/html":"Url",default:"Text"},ge="Copy to clipboard: #{key}, Enter";function ve(e){var t=(/mac os x/i.test(navigator.userAgent)?"âŒ˜":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}function ye(e,t){var r,m,x,h,f,n,g=!1;t||(t={}),r=t.debug||!1;try{x=he(),h=document.createRange(),f=document.getSelection(),n=document.createElement("span"),n.textContent=e,n.ariaHidden="true",n.style.all="unset",n.style.position="fixed",n.style.top=0,n.style.clip="rect(0, 0, 0, 0)",n.style.whiteSpace="pre",n.style.webkitUserSelect="text",n.style.MozUserSelect="text",n.style.msUserSelect="text",n.style.userSelect="text",n.addEventListener("copy",function(u){if(u.stopPropagation(),t.format)if(u.preventDefault(),typeof u.clipboardData>"u"){r&&console.warn("unable to use e.clipboardData"),r&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var y=O[t.format]||O.default;window.clipboardData.setData(y,e)}else u.clipboardData.clearData(),u.clipboardData.setData(t.format,e);t.onCopy&&(u.preventDefault(),t.onCopy(u.clipboardData))}),document.body.appendChild(n),h.selectNodeContents(n),f.addRange(h);var S=document.execCommand("copy");if(!S)throw new Error("copy command was unsuccessful");g=!0}catch(u){r&&console.error("unable to copy using execCommand: ",u),r&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),g=!0}catch(y){r&&console.error("unable to copy using clipboardData: ",y),r&&console.error("falling back to prompt"),m=ve("message"in t?t.message:ge),window.prompt(m,e)}}finally{f&&(typeof f.removeRange=="function"?f.removeRange(h):f.removeAllRanges()),n&&document.body.removeChild(n),x()}return g}var we=ye;const je=se(we),be=e=>{const t=e.icon;return a.jsx(a.Fragment,{children:a.jsx("div",{className:"relative flex cursor-pointer",onClick:e.clicked,children:a.jsx("div",{className:"icon-stack-border",children:a.jsx("div",{className:"icon-stack-border",children:a.jsx(t,{className:"icon-stack-icon"})})})})})};function Se({title:e,titleId:t,...r},m){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":t},r),e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M13 4.5a2.5 2.5 0 1 1 .702 1.737L6.97 9.604a2.518 2.518 0 0 1 0 .792l6.733 3.367a2.5 2.5 0 1 1-.671 1.341l-6.733-3.367a2.5 2.5 0 1 1 0-3.475l6.733-3.366A2.52 2.52 0 0 1 13 4.5Z"}))}const Me=l.forwardRef(Se),ke=Me;function Ne({title:e,titleId:t,...r},m){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":t},r),e?l.createElement("title",{id:t},e):null,l.createElement("path",{fillRule:"evenodd",d:"M13.887 3.182c.396.037.79.08 1.183.128C16.194 3.45 17 4.414 17 5.517V16.75A2.25 2.25 0 0 1 14.75 19h-9.5A2.25 2.25 0 0 1 3 16.75V5.517c0-1.103.806-2.068 1.93-2.207.393-.048.787-.09 1.183-.128A3.001 3.001 0 0 1 9 1h2c1.373 0 2.531.923 2.887 2.182ZM7.5 4A1.5 1.5 0 0 1 9 2.5h2A1.5 1.5 0 0 1 12.5 4v.5h-5V4Z",clipRule:"evenodd"}))}const Ce=l.forwardRef(Ne),De=Ce,Ee=e=>{const t=()=>{let r=!1,m=e.medals;for(let x of m)if(!v(x)){r=!0;break}return r};return a.jsx(a.Fragment,{children:a.jsxs("div",{id:"medal-set",className:"relative cutBottomPrimary",children:[a.jsxs("div",{className:"flex justify-center items-center gap-x-2 gap-y-2 lg:gap-8 lg:px-8 medalInner",children:[a.jsx(E,{name:"Medal1",editMedal:e.modifyMedal,displayPrimary:!1,deleteMedal:e.removeMedal,position:0,medal:e.medals[0]}),a.jsx(E,{name:"Medal2",editMedal:e.modifyMedal,displayPrimary:!1,deleteMedal:e.removeMedal,position:1,medal:e.medals[1]}),a.jsx(E,{name:"Medal3",editMedal:e.modifyMedal,displayPrimary:!1,deleteMedal:e.removeMedal,position:2,medal:e.medals[2]})]}),a.jsxs("div",{className:`flex justify-end items-center cursor-pointer translate-y-8 px-2 font-bold ${t()?"":"hidden"}`,onClick:e.emitSaveDrop,children:[a.jsx(U,{className:"bookmark-light"}),"Save"]})]})})},Te=l.lazy(()=>le(()=>import("./MedalList-05ccc6e1.js"),["assets/MedalList-05ccc6e1.js","assets/index-c87b6df6.js","assets/index-8dcf00ec.css","assets/MedalView-da9ce4e4.js"])),Re=()=>{const[e,t]=l.useState([{},{},{}]),[r,m]=l.useState({}),[x,h]=l.useState(!1),[f,n]=l.useState(!1),[g,S]=l.useState(!1),[u,y]=l.useState(!1),[V,T]=l.useState(!1),j=l.useRef(""),[M,k]=l.useState(""),[H,G]=l.useState(!0),N=()=>{let s=[];for(let o in localStorage){let d=JSON.parse(localStorage.getItem(o));if(!v(d)){let i={name:o,medals:d};s.push(i)}}return s},[_,I]=l.useState(N),J=(s,o)=>{X(s.id)?t(d=>d.map((i,p)=>p===o.position?s:i)):console.log("medal already exists in set")};function X(s){let o=!0,d=e;for(let i=0;i<d.length;i++)if(d[i]&&d[i].id===s){o=!1;break}return o}function Z(s){t(o=>o.map((d,i)=>i===s?{}:d))}async function K(){T(!0),je(j.current),await oe(1e3),T(!1)}function W(s){m({...e[s],position:s}),h(!0)}function Y(s,o,d){const i=e.map((p,w)=>w==d?{...p,set_traits:s,set_traits_values:o}:p);t(i),R()}function q(){k(M),localStorage.setItem(M,JSON.stringify(e)),I(N)}function C(){y(!u)}function R(){h(!1)}function A(){n(!f)}async function L(){console.log(JSON.stringify(e)),P(!0),S(!g)}function Q(s,o){k(o),t(s),A()}function ee(s){localStorage.removeItem(s),I(N)}function P(s){let d="/opbr-meddlr/#/share?medals=",i="",p="",w="";for(let c=0;c<e.length;c++)if(!v(e[c])){let b=ie(e[c].id);d+=c>e.length-2?F(b):`${F(b)}g`}if(s)for(let c=0;c<3;c++)v(e[0])?i+="zz":i+=D(e[0].set_traits[c],e[0].set_traits_values[c]),v(e[1])?p+="zz":p+=D(e[1].set_traits[c],e[1].set_traits_values[c]),v(e[2])?w+="zz":w+=D(e[2].set_traits[c],e[2].set_traits_values[c]);function D(c,b){const $=ce(c,b);return $||"zz"}const ae="&t="+i+p+w,te=window.location.href.substring(0,window.location.href.indexOf(window.location.pathname));j.current=te+d+ae}return a.jsx(l.Suspense,{fallback:a.jsx(z,{}),children:a.jsxs("div",{className:"flex",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("div",{className:"justify-center items-center side-icon-tab",children:[a.jsx(be,{icon:U,clicked:A}),a.jsx(ke,{className:"sidecon",onClick:L})]}),a.jsxs("div",{className:`flex fixed flex-col items-end focus-dropdown ${g&&"drop-appear"}`,children:[a.jsxs("div",{className:"flex w-full justify-between",children:[a.jsxs("div",{className:"flex flex-row toolbar",children:[a.jsx("input",{className:"rounded-sm transparent",type:"checkbox",checked:H,onChange:s=>{G(s.target.checked),P(s.target.checked)}}),a.jsx("span",{className:"text-xs px-1",children:"include traits"})]}),a.jsx(B,{className:"cursor-pointer -translate-y-2 icon-small-grey",onClick:s=>{L(),s.currentTarget.classList.remove("flash-slow")}})]}),a.jsxs("div",{className:"flex items-center p-0",children:[a.jsx(De,{className:`rounded-xl cursor-pointer icon-small-primary ${V?"flash-slow":""}`,onClick:K}),a.jsx("input",{className:"rounded-lg",ref:j,value:j.current,readOnly:!0})]})]})]}),a.jsx("div",{className:`flex flex-col gap-y-2 rounded-md phalange ${f&&"show-phalange"}`,children:_.length>0?_.map((s,o)=>a.jsx(re,{emitLoad:Q,deleteSet:ee,medals:s.medals,name:s.name},o)):a.jsx("div",{class:"text-primary text-center py-10",children:"You have no medals saved"})}),a.jsx(de,{backend:me?ue:fe,children:a.jsxs("div",{className:`flex flex-col overflow-hidden lg:overflow-x-auto md:flex-row justify-center rounded-md p-2 gap-4 w-full main-content ${f&&" push-right-xl"}`,children:[a.jsxs("div",{id:"medal-set-card",className:"flex flex-col max-h-[400px] md:max-h-[650px] lg:max-[800px] gap-y-4 cutTop",children:[a.jsx("div",{className:`absolute h-4/6 h-3/4 md:h-3/5 z-20 modal ${x?"showModal":"hideModal"}`,children:a.jsx(xe,{edit:!0,saveMedalTraits:Y,medal:r,closeWindow:R})}),a.jsxs("div",{className:`flex flex-col fixed justify-end translate-x-32 translate-y-12 focus-dropdown ${u?"drop-appear":""}`,children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-primary",children:"Set name"}),a.jsx(B,{className:"-translate-y-2 cursor-pointer icon-small-grey",onClick:C})]}),a.jsx("input",{className:"rounded-md",value:M,onChange:s=>k(s.target.value)}),a.jsx("div",{className:"py place-self-center clickable-button",onClick:()=>{q(),C()},children:"Save"})]}),a.jsx(Ee,{emitSaveDrop:C,modifyMedal:W,removeMedal:Z,medals:e}),a.jsx(ne,{medals:e})]}),a.jsx("div",{className:"lg:w-1/2 max-h-[375px] md:max-h-[650px] lg:max-h-[700px] overflow-y-auto",children:a.jsx(l.Suspense,{fallback:a.jsx(z,{}),children:a.jsx(Te,{dropped:J})})})]})})]})})};export{Re as default};
